<% include partials/header %>

<% var test = (foundPoll); %>
<% var dataArray = dataArray; %>
<% var id = foundPoll._id.toString(); %>

<div class="text-center">
  <h1><%= foundPoll.pollName %></h1>
  <p>
    Some random description about <%= foundPoll.pollName %>
  </p>
  </div>

  <script type="text/javascript">

  // Load the Visualization API and the corechart package.
  google.charts.load('current', {'packages':['corechart']});

  // Set a callback to run when the Google Visualization API is loaded.
  google.charts.setOnLoadCallback(drawChart);

  // Callback that creates and populates a data table,
  // instantiates the pie chart, passes in the data and
  // draws it.
  function drawChart() {

    var foundPoll = <%- JSON.stringify(test) %>;

    // Create the data table.
    var data = new google.visualization.DataTable();
    data.addColumn('string', foundPoll.pollName);
    data.addColumn('number', 'Percentage');

    var dataArray = <%- JSON.stringify(dataArray) %>;
    data.addRows(dataArray);
    // Set chart options
    var options = {'title':foundPoll.pollName,
    'width':800,
    'height':800,
    pieHole: 0.4
  };

  // Instantiate and draw our chart, passing in some options.
  var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
  chart.draw(data, options);
}
</script>


<div class="container">
  <div class="row">
    <div class="col-lg-2">
      <form action="/polls/<%= foundPoll._id %>" method="post">
        <label for="">I'd Like to Vote For:</label>
        <select class="" name="vote">
          <option></option>
          <% foundPoll.items.forEach(function(poll){ %>
            <option value='<%= poll.name %>'><%= poll.name %></option>
            <% }); %>
          </select>
          <button class='btn btn-primary'type="submit" name="button">Submit</button>
        </form>
        <% if (currentUser){ %>
          <form action='/polls/<%= foundPoll._id %>/addedVote' method='post'>
            <input type='text' name='addedUserPoll' placeholder='Or Add A New Option'>
            <button class='btn btn-info' type='submit' style='margin-top: 5px;'>Add New Option</button>
          </form>
        <%  }  %>
    </div>

    <div class="col-lg-10">
     <div id='chart_div'>

     </div>
   </div>
  </div>
</div>


  <% include partials/footer %>
